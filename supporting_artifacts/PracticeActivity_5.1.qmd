---
title: "Practice Activity 5.1"
execute:
  echo: true
  error: true 
author: "Fiona Norton"
format: 
  html: 
    code-fold: true
    code-summary: "Show code"
    theme: "materia"
editor: visual
---

## Setup 

```{r}
#| message: false
library(tidyverse)
library(lubridate)
suspect_times <- read_csv(here::here("datasets", "suspect_times.csv"))
```

# Who is the "Zodiac Killer"? 

## Hints about the killer

Based on the sunburn patterns on the body, the murder was not committed in the morning.

The room where the murder was committed is closed Tuesdays and Thursdays, so the murder did not happen on those days.

It is believed that the murder was committed within 5 weeks (35 days) of Thanksgiving, 2018.

It was discovered that just before being murdered, the victim tried to send a text to their sister in Iceland, saying “Goodnight over there!”

The Killer left behind a birthday card at the scene of the crime. The date is smudged, but the number of the month is shown to be 22. It is thought that perhaps this murder took place less than two days after the Killer’s birthday.

The Killer is amused by our efforts, and he has sent us a cryptic clue: “The number of minutes between Jan 1, 1970 at midnight and the time I arrived on the scene is divisible by 10.”

## Clean the data 

```{r}
suspect_times <- suspect_times |> 
  mutate(Time.Spotted = ymd_hms(Time.Spotted, tz = "America/Los_Angeles")) 
```

## Find the killer

```{r}
suspect_times <- suspect_times|> 
  filter(am(Time.Spotted) == FALSE,
         wday(Time.Spotted, label = TRUE) != "Tuesday",
         wday(Time.Spotted, label = TRUE) != "Thursday",
         Time.Spotted <= (thanksgiving + days(35)),
         Time.Spotted >= (thanksgiving - days(35))) |> 
  mutate(Time.Spotted = with_tz(Time.Spotted, tzone = "GMT")) |>  #Iceland time
  filter(pm(Time.Spotted) == TRUE) |> #nighttime in Iceland
  mutate(Time.Spotted = with_tz(Time.Spotted, tzone = "America/Los_angeles")) |> 
  filter(day(Time.Spotted) >= 22,
         day(Time.Spotted) < 24) |> 
  mutate(minutes = (as.integer(difftime(Time.Spotted, jan1_1970, units = "mins") ))) |> 
  filter((minutes %% 10) == 0)
  
```

Thanksgiving Date 

```{r}
thanksgiving = make_date(year = 2018, month = 11, day = 22)
thanksgiving <- force_tz(thanksgiving, tzone = "America/Los_Angeles")
jan1_1970 <- ymd_hms("1970-01-01 00:00:00", tz = "America/Los_Angeles")

```


